# 静态网站移植到懒猫微服完整指南

本指南详细介绍如何将静态网站（如2048游戏）移植到懒猫微服平台，重点是LPK打包过程。

## 一、准备工作

### 1. 确保静态网站功能完整

- 包含所有必要的HTML、CSS和JavaScript文件
- 确保所有资源链接为相对路径
- 验证网站在本地能正常运行（通过浏览器打开index.html）

### 2. 准备必要工具

- 基本命令行工具：tar、zip、unzip
- 图像处理工具（可选，用于准备图标）

## 二、静态网站LPK打包流程

### 1. 创建打包工作目录

```bash
# 创建工作目录
mkdir -p website-lpk
cd website-lpk
```

### 2. 创建manifest.yml文件

```bash
# 创建manifest.yml文件
cat > manifest.yml << 'EOF'
lzc-sdk-version: 0.1
name: 网站名称
package: com.yourname.website
version: 0.0.1
description: 网站描述信息
license: MIT
homepage: https://github.com/yourusername/website
author: 您的名字
application:
  subdomain: yourwebsite
  routes:
    - /=file:///lzcapp/pkg/content/
  public_path:
    - /
EOF
```

#### manifest.yml关键参数说明：

- `name`: 应用在微服上显示的名称
- `package`: 应用唯一标识符，建议使用反向域名格式
- `version`: 应用版本号
- `subdomain`: 访问应用的子域名前缀
- `routes`: 路由配置，`file:///lzcapp/pkg/content/`表示使用静态文件方式部署

### 3. 准备应用图标

```bash
# 准备256×256像素的PNG格式图标
cp /path/to/your/icon.png icon.png

# 如果需要转换或调整图标
# convert original-icon.png -resize 256x256 icon.png
```

### 4. 打包网站内容

```bash
# 进入网站根目录
cd /path/to/your/website

# 打包所有文件为content.tar
tar -cf /path/to/website-lpk/content.tar *

# 返回打包目录
cd /path/to/website-lpk
```

### 5. 创建LPK包

```bash
# 将所有文件打包为LPK
zip -r ../website.lpk manifest.yml content.tar icon.png
```

## 三、安装和测试

### 1. 安装到懒猫微服

```bash
# 通过SSH连接到懒猫微服
ssh root@您的微服名称.heiyu.space

# 使用lzc-cli工具安装应用
lzc-cli app install /path/to/website.lpk
```

### 2. 验证应用状态

```bash
# 查看应用状态
lzc-cli app status com.yourname.website
```

### 3. 访问应用

通过浏览器访问：`https://yourwebsite.您的微服名称.heiyu.space`

## 四、常见问题和注意事项

### 1. 路径问题

- 确保网站中所有资源链接使用相对路径，不要使用绝对路径
- 例如使用`./style/main.css`而不是`/style/main.css`

### 2. 文件权限

- 打包前确保所有文件有正确的读取权限
- 如有需要写入的目录，在manifest.yml中配置适当的挂载点

### 3. 跨域问题

- 如果网站需要访问外部API，可能需要处理跨域问题
- 考虑在懒猫微服上配置反向代理或CORS头

### 4. 内容优化

- 压缩HTML、CSS和JavaScript文件减小体积
- 优化图片大小减少加载时间

## 五、高级配置

### 1. 配置多个路由

如果需要配置多个路由路径，可以在manifest.yml中添加：

```yaml
application:
  routes:
    - /=file:///lzcapp/pkg/content/
    - /api=http://backend-service:8080/
```

### 2. 自定义404页面

```yaml
application:
  public_path:
    - /
  error_page:
    - 404=/404.html
```

### 3. 环境变量配置

如果您的静态网站需要在构建时注入环境变量：

```yaml
application:
  environment:
    - API_URL=https://api.example.com
```

## 六、示例：2048游戏移植步骤

### 1. 创建manifest.yml

```bash
cat > manifest.yml << 'EOF'
lzc-sdk-version: 0.1
name: 2048游戏
package: com.yourname.game2048
version: 0.0.1
description: 经典的2048数字拼图游戏
license: MIT
homepage: https://github.com/gabrielecirulli/2048
author: Gabriele Cirulli
application:
  subdomain: game2048
  routes:
    - /=file:///lzcapp/pkg/content/
  public_path:
    - /
EOF
```

### 2. 准备图标

```bash
# 从项目中提取图标
cp meta/apple-touch-icon.png icon.png
# 或
convert favicon.ico -resize 256x256 icon.png
```

### 3. 打包内容

```bash
# 打包所有文件
tar -cf content.tar index.html style js meta favicon.ico LICENSE.txt README.md
```

### 4. 创建LPK

```bash
zip -r 2048-game.lpk manifest.yml content.tar icon.png
```

### 5. 安装测试

```bash
lzc-cli app install 2048-game.lpk
```

遵循本指南，您可以轻松将任何静态网站移植到懒猫微服平台，无需复杂的容器化或后端配置。这种方法特别适合静态博客、游戏、文档和展示型网站。 